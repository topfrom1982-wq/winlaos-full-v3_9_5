<!DOCTYPE html>
<html lang="lo">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hyper88 | ‡∫ó‡∫≤‡∫á‡ªÄ‡∫Ç‡∫ª‡ªâ‡∫≤‡∫´‡∫º‡∫¥‡ªâ‡∫ô</title>

<!-- ‚úÖ Facebook Pixel -->
<script>
!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '1519822972491842');
fbq('track', 'PageView');
</script>
<noscript>
  <img height="1" width="1" style="display:none"
  src="https://www.facebook.com/tr?id=1519822972491842&ev=PageView&noscript=1"/>
</noscript>

<style>
body {
  margin:0;
  font-family:'Noto Sans Lao','Kanit',sans-serif;
  background:#000;
  color:#fff;
  text-align:center;
}
.container {
  max-width:420px;
  margin:auto;
  padding:20px;
}
.logo {
  width:160px;
  margin-top:60px;
}
button {
  width:100%;
  border:none;
  border-radius:14px;
  padding:16px;
  font-size:1.1rem;
  font-weight:600;
  cursor:pointer;
  margin-top:20px;
  transition:all 0.25s ease;
}
#enterBtn {
  background:linear-gradient(90deg,#FFD700,#E6B800);
  color:#000;
}
#contactBtn {
  background:linear-gradient(90deg,#1877F2,#0e5dc7);
  color:#fff;
}
#enterBtn:hover, #winlaos_confirm:hover {
  transform:scale(1.05);
  box-shadow:0 0 25px #FFD700aa;
}
footer {
  margin:40px 0 20px;
  font-size:0.8rem;
  color:#777;
}

/* Popup */
.popup-overlay {
  display:none;
  position:fixed;
  top:0;left:0;
  width:100%;height:100%;
  background:rgba(0,0,0,0.85);
  justify-content:center;
  align-items:center;
}
.popup {
  background:#111;
  border:1px solid #FFD70050;
  border-radius:14px;
  padding:25px 20px;
  width:80%;
  max-width:340px;
}
.popup h2 {
  color:#FFD700;
  margin-bottom:15px;
}
.popup input {
  width:85%;
  padding:10px;
  border-radius:8px;
  border:1px solid #FFD70080;
  background:#000;
  color:#fff;
  margin-bottom:15px;
  text-align:center;
}
#winlaos_confirm {
  background:linear-gradient(90deg,#FFD700,#E6B800);
  color:#000;
  font-weight:bold;
  box-shadow:0 0 15px #FFD70060;
}
#winlaos_close {
  background:#333;
  color:#fff;
  margin-top:8px;
}
</style>
</head>
<body>
<div class="container">
  <img src="images/hyper88.webp" alt="hyper88" class="logo">
  <h1>‡∫ç‡∫¥‡∫ô‡∫î‡∫µ‡∫ï‡ªâ‡∫≠‡∫ô‡∫Æ‡∫±‡∫ö‡∫™‡∫π‡ªà <span style="color:#FFD700">Hyper88</span> üé∞</h1>
  <button id="enterBtn">üé∞ ‡∫ó‡∫≤‡∫á‡ªÄ‡∫Ç‡∫ª‡ªâ‡∫≤‡∫´‡∫º‡∫¥‡ªâ‡∫ô</button>
  <button id="contactBtn" onclick="window.open('https://m.me/840186929171670','_blank')">üí¨ ‡∫ï‡∫¥‡∫î‡∫ï‡ªç‡ªà‡ªÅ‡∫≠‡∫î‡∫°‡∫¥‡∫ô</button>
  <footer>¬© 2025 Hyper88. All rights reserved.</footer>
</div>

<!-- ‚úÖ Popup -->
<div class="popup-overlay" id="popupOverlay">
  <div class="popup">
    <h2>‡ªÉ‡∫™‡ªà‡ªÄ‡∫ö‡∫µ‡ªÇ‡∫ó‡∫Ç‡∫≠‡∫á‡∫ó‡ªà‡∫≤‡∫ô</h2>
    <input 
      type="tel" 
      id="winlaos_phone" 
      value="020" 
      maxlength="11" 
      pattern="[0-9]*"
      inputmode="numeric"
      oninput="if(!this.value.startsWith('020')) this.value='020'+this.value.replace(/[^0-9]/g,'').replace(/^0+/,''); if(this.value.length>11) this.value=this.value.slice(0,11);" 
      readonly 
      onfocus="this.removeAttribute('readonly'); setTimeout(()=>this.setSelectionRange(this.value.length,this.value.length),0);"
    >
    <button id="winlaos_confirm">‡∫¢‡∫∑‡∫ô‡∫¢‡∫±‡∫ô</button>
    <button id="winlaos_close">‡∫õ‡∫¥‡∫î</button>
  </div>
</div>

<script>
(() => {
  const PIXEL_ID = "1519822972491842";
  const ACCESS_TOKEN = "EAARsThrgc2oBP6b5LegvS6KcILwjhy4hhQ1FrhqdOkwJABf9PsKIevpmhS2rXgoOTmc5u2omZBj0qloSmMQr32IrnHiKOEFZCmC20EdnBXFOBRfnTIErZAATT9sO2vucWXgU64ZCDiuuykWzmazbTQ8XJEWLIMz51LVuyHfeKbfzY8YkPpaKMI1bpNTapQZDZD";
  const REDIRECT_URL = "https://mvpatm.pro";

  const popup = document.getElementById("popupOverlay");
  const enterBtn = document.getElementById("enterBtn");
  const confirmBtn = document.getElementById("winlaos_confirm");
  const closeBtn = document.getElementById("winlaos_close");
  const phoneInput = document.getElementById("winlaos_phone");
  const savedPhone = localStorage.getItem("hyper88_phone");

  console.log("üü° Hyper88 Debug: Script loaded");
  console.log("‚ÑπÔ∏è Saved phone:", savedPhone);

  // ‚úÖ Helper: SHA-256
  async function sha256(message) {
    const msgBuffer = new TextEncoder().encode(message);
    const hashBuffer = await crypto.subtle.digest("SHA-256", msgBuffer);
    return Array.from(new Uint8Array(hashBuffer))
      .map(b => b.toString(16).padStart(2, "0")).join("");
  }

  // ‚úÖ Helper: ‡∏î‡∏∂‡∏á fbc / fbp ‡∏à‡∏≤‡∏Å cookie
  function getFBC() {
    try {
      const match = document.cookie.match(/_fbc=([^;]+)/);
      return match ? match[1] : null;
    } catch {
      return null;
    }
  }

  function getFBP() {
    try {
      const match = document.cookie.match(/_fbp=([^;]+)/);
      return match ? match[1] : null;
    } catch {
      return null;
    }
  }

  // ‚úÖ ‡∏¢‡∏¥‡∏á event ‡πÑ‡∏õ Facebook
  async function sendMetaEvent(phone) {
    console.log("üöÄ Sending event for phone:", phone);

    // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏´‡∏±‡∏™‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡∏•‡∏≤‡∏ß
    if (phone.startsWith("020")) {
      phone = "856" + phone.substring(1);
    }

    const eventTime = Math.floor(Date.now() / 1000);
    const hashedPhone = await sha256(phone.trim());
    const fbc = getFBC();
    const fbp = getFBP();

    console.log("üîπ Hashed phone:", hashedPhone);
    console.log("üîπ fbc:", fbc);
    console.log("üîπ fbp:", fbp);

    const userData = {
      ph: hashedPhone,
      external_id: hashedPhone,
      fbc: fbc,
      fbp: fbp,
      country: "LA",
      client_user_agent: navigator.userAgent
    };

    const payload = {
      data: [{
        event_name: "Purchase",
        event_time: eventTime,
        action_source: "website",
        event_source_url: window.location.href,
        user_data: userData,
        custom_data: { currency: "USD", value: 1.00 },
        test_event_code: "TEST1234" // ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏´‡∏°‡∏î‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÉ‡∏ô Events Manager
      }]
    };

    console.log("üì¶ Payload ready:", payload);

    try {
      const res = await fetch(`https://graph.facebook.com/v20.0/${PIXEL_ID}/events?access_token=${ACCESS_TOKEN}`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload)
      });

      const text = await res.text();
      console.log("‚úÖ Facebook Response:", text);

      fbq('track', 'Purchase', { currency: "USD", value: 1.00 });
      console.log("üí° fbq track('Purchase') sent to Pixel ID:", PIXEL_ID);
    } catch (err) {
      console.error("‚ùå Error sending event:", err);
    }
  }

  // ‚úÖ ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏•‡πà‡∏ô
  enterBtn.onclick = async () => {
    console.log("üé∞ Clicked enter button");
    if (savedPhone) {
      await sendMetaEvent(savedPhone);
      setTimeout(() => (window.location.href = REDIRECT_URL), 800);
    } else popup.style.display = "flex";
  };

  // ‚úÖ ‡∏õ‡∏∏‡πà‡∏°‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÄ‡∏ö‡∏≠‡∏£‡πå
  confirmBtn.onclick = async () => {
    console.log("üì≤ Confirm phone button clicked");
    let phone = phoneInput.value.trim();
    if (!phone.startsWith("020")) phone = "020" + phone.replace(/^0+/, "");
    if (!phone.match(/^020[0-9]{6,8}$/)) return alert("‚ö†Ô∏è ‡ªÉ‡∫™‡ªà‡ªÄ‡∫ö‡∫µ‡ªÉ‡∫´‡ªâ‡∫ñ‡∫∑‡∫Å‡∫ï‡ªâ‡∫≠‡∫á!");
    localStorage.setItem("hyper88_phone", phone);
    console.log("üíæ Saved phone:", phone);
    await sendMetaEvent(phone);
    popup.style.display = "none";
    alert("‚úÖ ‡∫™‡∫≥‡ªÄ‡∫•‡∫±‡∫î! ‡∫Å‡∫≥‡∫•‡∫±‡∫á‡ªÄ‡∫Ç‡∫ª‡ªâ‡∫≤...");
    setTimeout(() => (window.location.href = REDIRECT_URL), 800);
  };

  // ‚úÖ ‡∏õ‡∏∏‡πà‡∏°‡∏õ‡∏¥‡∏î popup
  closeBtn.onclick = () => {
    console.log("‚ùé Popup closed");
    popup.style.display = "none";
  };
})();
</script>

</body>
</html>
